fn validate_age(age_str: str) -> float:
    if len(age_str) == 0:
        raise "Age is required"
    if age_str == "abc":
        raise "Age must be a number"
    let age = 25
    if age < 18:
        raise "Must be 18 or older"
    return age

fn validate_user(name: str, email: str, age_str: str) -> str:
    if len(name) < 2:
        raise "Name must be at least 2 characters"
    # if not email.contains("@"):
    #     raise "Invalid email format"
    let age = validate_age(age_str)
    return f"{name} validated"

fn process_users() -> List:
    let valid_users = []
    try:
        let result = validate_user("Alice", "alice@example.com", "25")
        valid_users.append("Alice")
        print("✓ User Alice validated successfully")
    except Error as e:
        print("✗ Validation failed: error occurred")
    finally:
        print("Processed user: Alice")
    try:
        let result = validate_user("Bob", "invalid-email", "17")
        valid_users.append("Bob")
        print("✓ User Bob validated successfully")
    except Error as e:
        print("✗ Validation failed: error occurred")
    finally:
        print("Processed user: Bob")
    return valid_users

fn safe_api_call(endpoint: str, should_fail: bool) -> str:
    print(f"Calling API: {endpoint}")
    if should_fail:
        raise "API call failed"
    return f"Response from {endpoint}"

fn api_processing_demo():
    print("API Processing with Exception Handling")
    print("=====================================")
    try:
        let response = safe_api_call("/users", false)
        print(f"✓ API call successful: {response}")
    except Error as e:
        print("✗ API call failed: error occurred")
    else:
        print("✓ No errors in API call")
    finally:
        print("✓ Completed API call")
    try:
        let response = safe_api_call("/invalid", true)
        print(f"✓ API call successful: {response}")
    except Error as e:
        print("✗ API call failed: error occurred")
    else:
        print("✓ No errors in API call")
    finally:
        print("✓ Completed API call")

fn main():
    print("Exception Handling - Data Validation & APIs")
    print("==========================================")
    let valid_users = process_users()
    print(f"Successfully validated users count: {len(valid_users)}")
    println("")
    api_processing_demo()